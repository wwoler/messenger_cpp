# messenger_cpp


# Требования:

C++17 minimum

Windows only

# 1)Участники:

wwoler

GhostRJY


# 2)Описание идеи:

сущесвтует класс(Chat), который работает с пользователем(ввод/ввыод данных) 

существует класс(DataBase), который работает с "базой данных" основанной на файлах json(чтение/запись файлов)

Используется готовая библиотека nlohman для работы с json файлами

Данные пользователей и сообщений записываются в json файлы

При необходимости их можно считать 

По умолчанию присутствует общий чат, для отправки/получения сообщений нужно указать его имя: "common_chat"

Для отправки/получения сообщений другим пользователям нужно указывать их < username >

# 3)Описание пользовательских типов и функций в проекте:

# Тип User
содержит данные пользователя:

1)логин

2)пароль

3)имя пользователя


Имеет контрукторы

сеттеры и геттеры для взаимодействия с объектом этого класса

# Тип Message

Cодержит информацию об отправленном сообщении

1)отправитель

2)получатель

3)содержание письма

4)время отправки письма


Имеет контрукторы

сеттеры и геттеры для взаимодействия с объектом этого класса

# Тип DataBase

Наследован открыто от класса Singleton, поэтому существует в единственном экземпляре

Является "backend" частью чата, данный класс не поддерживает ввод c клавитуры и ничего не выводит на экран. Он работает только с файлами json и возвращает результаты обращений к "базе данных"

Содержит все для работы с файлами "базой данных"

1)поток для файла с пользователями

2)поток для файлов с сообщениями

3)путь к "базе данных"

4)позиция в файле текущего авторизированного пользователя

Конструктор создает "базу данных" если она не была создана ранее:

1)json файл users(будет храниться информация пользователей)

2)отдельную папку где будут храниться сообщения

Если "база данных" уже существует, то в конструкторе класс получает handle к файлам "базы данных"

Деструктор: закрывает файл

Функции-члены:

1)to_json принимает в качестве аргумента ссылку на объект типа User или Message и возвращает void, используется для отправки переданных данных о пользователе или сообщении в файл "базы данных"

2)from_json принимает в качестве аргумента ссылку на объект типа User или Message и возвращает void, используется для извлечения данных о пользователе или сообщении из файла "базы данных"

3)login принимает в качестве аргумента ссылку на объект типа User  и возвращает true, если авторизация прошла успешна, в противном случае возвращает false.

4)SingUp принимаетв в качестве аргумента ссылку на объект типа User и выполняет регистрацию пользователя. Если пользователь с данным логином или именем существует, то функция вернет false, иначе функция передает данные нового пользователя функции to_json, которая записывает их в "базу данных" и возвращает true

5)isExisting  принимаетв в качестве аргумента ссылку на объект типа User и проверяет существование пользователя в "базе данных". Если пользователь с таким именем или логином существует возвращает true, иначе false

6)clear_chat  принимаетв в качестве аргументов ссылки на объекты типа User, выполняет очистку чата у двух пользователей одновременно и возвращает void

7)changeLogin принимаетв в качестве аргумента ссылку на объект типа User и возвращает void, выполняет изменение логина пользователя

8)changePassword принимаетв в качестве аргумента ссылку на объект типа User и возвращает void, выполняет изменение пароля пользователя

9)getMessages принимаетв в качестве аргументов ссылки на объекты типа wstring и возвращает vector<Message>, извлекает переписку определенного чата и возвращает вектор сообщений

10)sendMessage принимаетв в качестве аргумента ссылку на объект типа Message и возвращает void, выполняет отправку сообщения указанному пользователю или в указанный чат

11)adjustment очищает данные оставшиеся от старой структуры в файле, ничего не принимает в качестве аргументов и возвращает void


# Тип Сhat

Наследован открыто от класса Singleton, поэтому существует в единственном экземпляре

Является "frontend" частью чата, данный класс делает запросы у пользователя на ввод с клавиатуры некоторых данных. После сбора информации он направляет все
нужные данные классу DataBase. Так же данный тип выполняет проверку на корректность вводимых данных.

Содержит:

1)указталеь на класс DataBase

2)указатель на текущего пользователя

3)указатель на функцию котороя будет выполняться

4)статус авторизации пользователя


Конструктор по умолчанию



Функции-члены:

1)chatMenu выводит в консоль меню, не имеет параметров, возвращает void

2)userMenu выводит в консоль меню пользователя, не имеет параметров, возвращает void

3)chatBox  принимаетв в качестве аргументов ссылки на объекты типа wstring и на объект типа const int, делает отрисовку бокса для чата и возвращает void

4)login запрашивает у пользователя ввод данных с клавитуры для авторизации, не имеет параметров, возвращает void

5)signUp запрашивает у пользователя ввод данных с клавитуры для регистрации, не имеет параметров, возвращает void

6)chatLoop цикл с запросами выбора, пока не будет выхода из учетной записи, не имеет параметров, возвращает void

7)userLoop цикл с запросами выбора, пока не будет выхода из программы, не имеет параметров, возвращает void

8)action_for_chat запрос на выбор функций чата, не имеет параметров, возвращает void

9)action_for_user запрос на выбор доступных пользователю функций, не имеет параметров, возвращает void

10)getMessages запрашивает у пользователя ввод имени пользователя/чата для получения диалога, не имеет параметров, возвращает void

11)sendMessage запрашивает у пользователя ввод имени пользователя/чата и сообщения для отправки сообщения, не имеет параметров, возвращает void

12)clear_chat запрашивает у пользователя ввод имени пользователя для очистки диалога с ним(общий чат нельзя очищать), не имеет параметров, возвращает void

13)get_info выводит информация о пользователе(логин, имя, пароль), не имеет параметров, возвращает void

14)changePassword запрашивает у пользователя ввод нового пароля, не имеет параметров, возвращает void

15)changeLogin запрашивает у пользователя ввод нового логина, не имеет параметров, возвращает void

16)set_user_data принимаетв в качестве аргументов ссылки на объекты типа wstring и на объект типа const wregex, данная функция проверяет вводимые данные на корректность и возвращает true, если данные прошли проверку, иначе false

17)set_current_user принимаетв в качестве аргумента unique_ptr<User>, устанавливает нового авторизированного пользователя для работы с ним и возвращает void

18)logout прекращает цикл пользователя и очищает указатель на текущего пользователя, не имеет параметров, возвращает void

19)exit выбрасывает исключение CloseChat для завершения программы, не имеет параметров, возвращает void

20)flush_input_buffer очищает поток ввода от мусора, не имеет параметров, возвращает void

21)time_to_string принимаетв в качестве аргументов ссылку на объект типа time_t переводит тип time_t в wstring и возвращает объект типа wstring

22)set_data_base принимаетв в качестве аргумента указатель на объект типа DataBase и устанавливает "базу данных" в которую будет передавать данные, возвращает void

# Тип Erase
С помощью него можно создавать Non copyable классы

# Тип Singleton

Реализует паттерн singleton CRTP

# Тип CloseChat

Тип для выброса исключения при завершении чата

# 4)Как были распределены задачи в команде

wwoler: DataBase, Chat, Singleton

GhostRJY: Message, User


